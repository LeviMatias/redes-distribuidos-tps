import sys
from lib.client_udp import Client_udp
from lib.file_manager import FileManager
from lib.argument_parser import ArgParser
from lib.printer import VerbosePrinter
from lib.client_udp_gbn import Client_udp_gbn

if __name__ == "__main__":

    try:
        ArgParser.check_client_side_args(sys.argv)
        h, host, port, path, n, pr, gbn = ArgParser.parse_client_side(sys.argv)
    except AssertionError as e:
        print("Could not start application")
        print(e)
        h = True

    if not h:
        try:
            if gbn:
                client = Client_udp_gbn(host, port, FileManager(), pr)
            else:
                client = Client_udp(host, port, FileManager(), pr)
            client.upload(path, n)
        except ConnectionResetError:
            print("Remote connection forcibly closed! Try checking addr & port")
            

